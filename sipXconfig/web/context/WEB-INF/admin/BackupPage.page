<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE page-specification PUBLIC "-//Apache Software Foundation//Tapestry Specification 4.0//EN" "http://jakarta.apache.org/tapestry/dtd/Tapestry_4_0.dtd">
<!-- generated by Spindle, http://spindle.sourceforge.net -->
<page-specification class="org.sipfoundry.sipxconfig.site.admin.BackupPage">
  <description>Backup page</description>
  <inject property="adminContext" object="spring:adminContext"/>
  <property name="backupFiles" />
  <property name="backupPlan" />
  <property name="schedule"/>
  <property name="backupFile"/>
  <!--
     - B E A N S
     -->
  <bean name="validator" class="org.sipfoundry.sipxconfig.components.SipxValidationDelegate"/>
  <bean name="scheduledDaysPropertyModel_en" class="org.sipfoundry.sipxconfig.components.EnumPropertySelectionModel">
    <set name="options" value="@org.sipfoundry.sipxconfig.admin.ScheduledDay@DAYS_OF_WEEK_PLUS_EVERYDAY"/>
  </bean>
  <bean name="scheduledDaysPropertyModel" class="org.sipfoundry.sipxconfig.components.LocalizedOptionModelDecorator" lifecycle="page">
    <set name="model" value="bean:scheduledDaysPropertyModel_en"/>
    <set name="resourcePrefix" value="literal:scheduleDay."/>
    <set name="messages" value="messages"/>
  </bean>
  <!--
     - C O M P O N E N T S
     -->
  <component id="form" type="Form">
    <binding name="delegate" value="bean:validator"/>
    <binding name="listener" value="listener:submit"/>
  </component>
  <component id="errors" type="common/ErrorMsg"/>
  <component id="checkConfigs" type="Checkbox">
    <binding name="value" value="backupPlan.configs"/>
  </component>
  <component id="checkVoicemail" type="Checkbox">
    <binding name="value" value="backupPlan.voicemail"/>
  </component>
  <component id="limitCount" type="PropertySelection">
    <binding name="model" value="prop:backupLimitSelectionModel"/>
    <binding name="value" value="backupPlan.limitedCount"/>
  </component>
  <component id="backup" type="Submit">
    <binding name="listener" value="listener:backup"/>
    <binding name="value" value="message:backupNow"/>
  </component>
  <component id="ifResultsPresent" type="If">
    <binding name="condition" value="!backupFiles.empty"/>
    <binding name="element" value="literal:p"/>
  </component>
  <component id="ifInitialDescription" type="If">
    <binding name="condition" value="backupFiles.empty"/>
    <binding name="element" value="literal:p"/>
  </component>
  <component id="results" type="For">
    <binding name="source" value="backupFiles"/>
    <binding name="value" value="backupFile"/>
    <binding name="element" value="literal:li"/>
  </component>
  <component id="link" type="common/DownloadLink">
    <binding name="fileName" value="backupFile.name"/>
    <binding name="dirName" value="backupFile.parentFile.path"/>
    <binding name="contentType" value="literal:tar/x-gzip"/>
  </component>
  <component id="linkText" type="InsertText">
    <binding name="value" value="backupFile.path"/>
  </component>
  <component id="schedules" type="For">
    <binding name="source" value="backupPlan.schedules"/>
    <binding name="value" value="schedule"/>
    <binding name="element" value="literal:br"/>
  </component>
  <component id="dailyScheduleEnabled" type="Checkbox">
    <binding name="value" value="schedule.enabled"/>
  </component>
  <component id="dailyScheduledDay" type="PropertySelection">
    <binding name="model" value="bean:scheduledDaysPropertyModel"/>
    <binding name="value" value="schedule.scheduledDay"/>
  </component>
  <component id="dailyScheduledTime" type="TextField">
    <binding name="validators" value="validators:required"/>
    <binding name="translator" value="hivemind:spring:timeOfDayTranslator"/>
    <binding name="value" value="schedule.timeOfDay"/>
    <binding name="displayName" value="literal:Time Of Day"/>
  </component>
  <component id="ok" type="Submit">
    <binding name="listener" value="listener:ok"/>
    <binding name="value" value="literal:OK"/>
  </component>
</page-specification>
